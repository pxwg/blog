---
const { entry, locale, llmTranslated } = Astro.props;

// Extract current slug from URL path
const currentPath = Astro.url.pathname;
// Handle both prefixed (/en/article/slug) and non-prefixed (/article/slug) routes
const currentSlug = currentPath.replace(/^\/(zh|en)?\/article\//, '').replace(/\/$/, '');

// If the slug still contains '/article/', it means we're in the non-prefixed route
// and need to extract the slug differently
const finalSlug = currentSlug.includes('/article/')
  ? currentSlug.replace(/^\/article\//, '')
  : currentSlug;

// Check if this is an LLM-translated article using front matter or direct prop
const isLLMTranslated = entry?.data?.['llm-translated'] === true || llmTranslated === true;

const targetLocale = locale === 'zh' ? 'en' : 'zh';

// Generate target path using Astro's i18n routing
let targetPath = null;
if (isLLMTranslated) {
  targetPath = `/${targetLocale}/article/${finalSlug}/`;
}
---
{isLLMTranslated && targetPath && (
  <div class="translation-disclaimer">
    {locale === 'zh' ? (
      <span>
        ğŸ“ ç¿»è¯‘å£°æ˜ï¼šæœ¬æ–‡ç”± LLM ä»åŸæ–‡ç¿»è¯‘è€Œæ¥ï¼Œå¯èƒ½å­˜åœ¨ç¿»è¯‘ä¸å‡†ç¡®ä¹‹å¤„ã€‚å»ºè®®é˜…è¯» <a href={targetPath}>åŸæ–‡</a> ä»¥è·å¾—æœ€å‡†ç¡®çš„å†…å®¹ã€‚
      </span>
    ) : (
      <span>
        ğŸ“ Translation Notice: This article was translated from the original by LLM and may contain inaccuracies. Please refer to the <a href={targetPath}>original article</a> for the most accurate content.
      </span>
    )}
  </div>
)}

<style>
.translation-disclaimer {
  margin: 0.75em 0;
  padding: 0.75em 0.9em;
  border-left: 3px solid var(--dash-color, #007acc);
  background: var(--code-bg-color, #f8f9fa);
  border-radius: 6px;
  color: var(--text-secondary, #666);
  font-size: 0.9em;
  line-height: 1.35;
}

.translation-disclaimer a {
  color: var(--dash-color, #007acc);
  text-decoration: underline;
}

.translation-disclaimer a:hover {
  opacity: 0.8;
}
</style>
